#'
#' @param data
#' @param stim1
#' @param stim2
#'
#' @return
#' @export
#'
#' @examples
cross_prop.venn <- function(data, stim_list){
#data$spike_stimulus <- str_replace_all(data$spike_stimulus, "[123456789.]", "")
#stim_list <- str_replace_all(stim_list, "[123456789.]", "")
t <- data.table(table(data$spike_stimulus, data$Cell_id))
data <- lapply(stim_list, function(x) unique(t[t$N != 0 & t$V1 == x,]$V2))
names(data) <- stim_list
p <- ggvenn::ggvenn(data)
return(p)
}
dual_prop_travaux <- function(data, stim_list){
data$spike_stimulus <- str_replace_all(data$spike_stimulus, "[123456789.]", "")
stim_list <- unique(str_replace_all(stim_list, "[123456789.]", ""))
data <- data.table::setDT(data)
data_list <- lapply(seq(1,length(stim_list)), function(x) data[, paste0("stim",x)
:= spike_stimulus == stim_list[x]] )
data <- data_list[[length(data_list)]]
n_resp_tot <- length(unique(data$Cell_id))
#n_cells_list <- lapply(seq(1,length(stim_list)), function(x)
# length(unique(data[data[[paste0("stim",x)]] == TRUE, ]$Cell_id)))
#n_cells_joint_resp <- lapply(seq(1,length(stim_list)), function(x)
#length(unique(data[data[[paste0("stim",x)]] == TRUE, ]$Cell_id)))
# CrÃ©er le tableau de contingence avec les deux stimuli
#f <- contingency(data)
t <- data.table(table(data$spike_stimulus, data$Cell_id))
data <- lapply(stim_list, function(x) unique(t[t$N != 0 & t$V1 == x,]$V2))
names(data) <- stim_list
print(data)
# Filter cells responding to both stimuli
print(data[stim_list])
n_cells_tot <- 1000
n_resp <- c(length(data[[1]]), length(data[[2]]))
dual_resp <- length(unlist(intersect(data[[1]], data[[2]])))
table_final <- data.table(n_resp, n_resp_tot, dual_resp )
rownames(table_final) <- c(stim_list[[1]], stim_list[[2]])
colnames(table_final) <- c("N_Responders", "N_Responders_Tot", "Common_Response")
return(table_final)
}
guigui()
library(calipR)
library(ggplot2)
data <- prepareData("inst/extdata/test1", frame_rate = 1, duration_in_seconds = 30)
data
library(tidyr)
pivot_wider(
?pivot_wider
mat <- pivot_wider(data,names_from = "Cell_id", values_from = "Mean_Grey")
mat
mat <- pivot_wider(data[,1:2],names_from = "Cell_id", values_from = "Mean_Grey")
data[,1:2]
mat <- pivot_wider(data[,1:2],names_from = Cell_id, values_from = Mean_Grey)
mat <- pivot_wider(data[,1:2],names_from = Cell_id)
mat <- pivot_wider(data[,1:2],value_from ="Mean_Grey")
mat <- pivot_wider(data[,1:2], name_from = Cell_id, value_from ="Mean_Grey")
mat <- pivot_wider(data[,1:2])
data_split <-  split(data, data$Cell_id)
data_split <-  split(data, data$Cell_id)[, .(Cell_id,Mean_Grey)]
data_split <-  split(data, data$Cell_id)[, .(c(Cell_id,Mean_Grey))]
data_split <-  split(data, data$Cell_id)[, c(Cell_id,Mean_Grey))]
data_split <-  split(data, data$Cell_id)[, c(Cell_id,Mean_Grey)]
data_split <-  split(data, data$Cell_id)[, c("Cell_id","Mean_Grey")]
data_split <-  split(data[,.(Cell_id,Mean_Grey)], data$Cell_id)
data_split
mat <- lapply(data_split, function(x) x$Mean_Grey)
mat
do.call(cbind,mat)
mat <- do.call(cbind,mat)
View(mat)
guigui()
pos_bank <- readRDS("projects/test1/new_pos")
neg_bank <- readRDS("projects/test1/new_neg")
pos_bank
neg_bank
lapply(mat, print)
pos_dist_list <- data[, pos_dist := rucrdtw::ucrdtw_mv(patMat, .SD$Mean_Grey, dtwwindow =0.05)$distance, by = Cell_id])
pos_dist_list <- data[, pos_dist := rucrdtw::ucrdtw_mv(patMat, .SD$Mean_Grey, dtwwindow =0.05)$distance, by = Cell_id]
pos_dist_list <- data[, pos_dist := rucrdtw::ucrdtw_mv(pos_bank, .SD$Mean_Grey, dtwwindow =0.05)$distance, by = Cell_id]
interp_posBank <- data.table::as.data.table(interpolR(posBank, 100))
interp_posBank <- data.table::as.data.table(interpolR(pos_Bank, 100))
pos_bank <- readRDS("projects/test1/new_pos")
neg_bank <- readRDS("projects/test1/new_neg")
interp_posBank <- data.table::as.data.table(interpolR(pos_Bank, 100))
pos_bank
interp_posBank <- data.table::as.data.table(interpolR(pos_Bank, 100))
interp_posBank <- interpolR(pos_Bank, 100))
interp_posBank <- interpolR(pos_Bank, 100)
interp_posBank <- interpolR(pos_Bank, 100, type = "one")
interp_posBank <- interpolR(pos_bank, 100)
interp_posBank
interp_posBank <- interpolR(pos_bank, 300)
interp_posBank
pos_dist_list <- data[, pos_dist := rucrdtw::ucrdtw_mv(interp_posBank, .SD$Mean_Grey, dtwwindow =0.05)$distance, by = Cell_id]
pos_dist_list
pos_dist_list
interp_posBank <- interpolR(neg_bank, 300)
interp_posBank <- interpolR(pos_bank, 300)
interp_negBank <- interpolR(neg_bank, 300)
data[, neg_dist := rucrdtw::ucrdtw_mv(interp_negBank, .SD$Mean_Grey, dtwwindow =0.05)$distance, by = Cell_id]
View(data)
data[, Responder := ifelse(pos_dist < neg_dist, TRUE,FALSE)]
View(data)
data[.N, by = Cell_id]
data[, .SD[.N,] ,by = Cell_id]
non_responder <- data[Responder == FALSE]
non_responder <- data[Responder == FALSE, .SD[.N,], by = Cell_id]
non_responder
non_responders_cells <- unique(non_responder$Cell_id)
non_responders_cells
ggplot(non_responder[Cell_id == non_responders_cells[[1]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))+
geom_line(aes(x = time_frame, y = background))
ggplot(non_responder[Cell_id == non_responders_cells[[1]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(non_responder[Cell_id == non_responders_cells[[1]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[1]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[2]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[3]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[4]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[5]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[6]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[7]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[8]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[9]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[10]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[11]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[12]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[13]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[14]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[15]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[16]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[17]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[18]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[19]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[20]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[21]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[22]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[23]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[24]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[25]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[26]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[27]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[28]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[29]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[30]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[31]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[32]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[33]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[34]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[35]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[36]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[37]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[38]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[39]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[40]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[40]
non_responders_cells[[40]]
non_responders_cells
non_responders_cells[[40]]
data[Cell_id == "A1abz"]
ggplot(data[Cell_id == non_responders_cells[[41]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[41]]
data[Cell_id == "A1aca"]
ggplot(data[Cell_id == non_responders_cells[[42]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[43]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[44]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[45]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[45]]
data[Cell_id == "A1acf"]
13/11
data[, ratio := pos_dist/neg_dist]
non_responder <- data[Responder == FALSE, .SD[.N,], by = Cell_id]
non_responders_cells <- unique(non_responder$Cell_id)
data[Cell_id == "A1acf"]
data[Cell_id == "A1aaa"]
data[Cell_id == "A1aab"]
ggplot(data[Cell_id == non_responders_cells[[46]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[47]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[48]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[49]]
data[Cell_id == "A1acl"]
ggplot(data[Cell_id == non_responders_cells[[50]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[51]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[52]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[53]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[54]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[55]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[56]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[57]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[58]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[589]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[59]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[60]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[61]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[62]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[63]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[64]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[65]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[66]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[67]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[67]]
data[Cell_id == "A1adp"]
ggplot(data[Cell_id == non_responders_cells[[68]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[68]]
data[Cell_id == "A1adq"]
clean_data <- clean_data(data, moving_threshold = 0.1, mean_width = 10,
mean_width_diff = 10,DPA_width =10, CN_DPA_width =10)
clean_data
clean_data[, pos_dist := rucrdtw::ucrdtw_mv(interp_posBank, .SD$local_mean, dtwwindow =0.05)$distance, by = Cell_id]
clean_data[, neg_dist := rucrdtw::ucrdtw_mv(interp_negBank, .SD$local_mean, dtwwindow =0.05)$distance, by = Cell_id]
clean_data[, Responder := ifelse(pos_dist < neg_dist, TRUE,FALSE)]
clean_data[, ratio := pos_dist/neg_dist]
non_responder <- clean_data[Responder == FALSE, .SD[.N,], by = Cell_id]
non_responders_cells <- unique(non_responder$Cell_id)
ggplot(data[Cell_id == non_responders_cells[[68]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[68]]
non_responder
clean_data[Cell_id == "A1ahd"]
ggplot(data[Cell_id == non_responders_cells[[1]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[2]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[3]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[4]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[5]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[6]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[7]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[8]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[9]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[10]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[11]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[12]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[13]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[14]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[15]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[16]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[17]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[18]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[19]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[20]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[21]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[22]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[23]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[24]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[25]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[26]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[27]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[28]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[29]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == non_responders_cells[[27]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
non_responders_cells[[27]]
clean_data[Cell_id == "A1acl"]
max(clean_data[Cell_id == "A1acl"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aaa"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aab"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aac"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aad"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aae"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aaf"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aag"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aah"]$first_derivative, na.rm =TRUE)
max(clean_data[Cell_id == "A1aa"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aaa"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aad"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aae"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aab"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aac"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aaf"]$smooth_Diff, na.rm =TRUE)
max(clean_data[Cell_id == "A1aag"]$smooth_Diff, na.rm =TRUE)
ggplot(data[Cell_id == "A1aaf"])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == "A1aac"])+
geom_line(aes(x = time_frame, y = Mean_Grey))
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := max(smooth_Diff, na.rm = TRUE) > 5]
clean_data
no <- clean_data[responder_diff == FALSE]
no
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(smooth_Diff, na.rm = TRUE) > 5,TRUE,FALSE]
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(smooth_Diff, na.rm = TRUE) > 5,TRUE,FALSE)]
no <- clean_data[responder_diff == FALSE]
no
clean_data
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(smooth_Diff, na.rm = TRUE) > 5,TRUE,FALSE), by = Cell_id]
no <- clean_data[responder_diff == FALSE]
no
unique(no$Cell_id)
data[ratio >= 2]
unique(data[ratio >= 2]$Cell_id)
unique(data[ratio >= 1.5]$Cell_id)
unique(data[ratio >= 1]$Cell_id)
unique(data[ratio >= 1.1]$Cell_id)
unique(data[ratio >= 1.2]$Cell_id)
non_responder <- clean_data[Responder == FALSE, .SD[.N,], by = Cell_id]
non_responders_cells <- unique(non_responder$Cell_id)
no_cells <- unique(no$Cell_id)
no_cells
ggplot(data[Cell_id == no_cells[[1]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == no_cells[[2]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == no_cells[[3]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == no_cells[[4]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
ggplot(data[Cell_id == no_cells[[5]]])+
geom_line(aes(x = time_frame, y = Mean_Grey))
lapply(no_cells, function(x)
ggplot(data[Cell_id == x])+
geom_line(aes(x = time_frame, y = Mean_Grey)))
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(smooth_Diff, na.rm = TRUE) > 2,TRUE,FALSE), by = Cell_id]
no <- clean_data[responder_diff == FALSE]
no_cells <- unique(no$Cell_id)
no_cells
lapply(no_cells, function(x)
ggplot(data[Cell_id == x])+
geom_line(aes(x = time_frame, y = Mean_Grey)))
no_cells
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(first_derivative, na.rm = TRUE) > 2,TRUE,FALSE), by = Cell_id]
no <- clean_data[responder_diff == FALSE]
no_cells <- unique(no$Cell_id)
no_cells
clean_data
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(first_derivative, na.rm = TRUE) > 5,TRUE,FALSE), by = Cell_id]
no <- clean_data[responder_diff == FALSE]
no_cells <- unique(no$Cell_id)
non_responders_cells
no_cells
lapply(no_cells, function(x)
ggplot(data[Cell_id == x])+
geom_line(aes(x = time_frame, y = Mean_Grey)))
# utilisant un critÃ¨re de dÃ©rivÃ©e :
clean_data[, responder_diff := ifelse(max(first_derivative, na.rm = TRUE) > 10,TRUE,FALSE), by = Cell_id]
no <- clean_data[responder_diff == FALSE]
no_cells <- unique(no$Cell_id)
no_cells
lapply(no_cells, function(x)
ggplot(data[Cell_id == x])+
geom_line(aes(x = time_frame, y = Mean_Grey)))
data[, diff_dist := pos_dist - neg_dist]
data[diff_dist >1]
unique(data[diff_dist >1]$Cell_id)
unique(data[diff_dist >2]$Cell_id)
unique(data[diff_dist >3]$Cell_id)
no_cells_diff_dist <- unique(data[diff_dist >3]$Cell_id)
lapply(no_cells_diff_dist, function(x)
ggplot(data[Cell_id == x])+
geom_line(aes(x = time_frame, y = Mean_Grey)))
?rucrdtw::ucrdtw_mv
data[, pos_dist := rucrdtw::ucrdtw_mv(interp_posBank, .SD$Mean_Grey, dtwwindow =0.5)$distance, by = Cell_id]
data[, neg_dist := rucrdtw::ucrdtw_mv(interp_negBank, .SD$Mean_Grey, dtwwindow =0.5)$distance, by = Cell_id]
data[, Responder := ifelse(pos_dist < neg_dist, TRUE,FALSE)]
data[, ratio := pos_dist/neg_dist]
data[, diff_dist := pos_dist - neg_dist]
non_responder <- data[Responder == FALSE, .SD[.N,], by = Cell_id]
non_responders_cells <- unique(non_responder$Cell_id)
non_responders_cells
non_responders_cells
unique(data[diff_dist > 3]$Cell_id)
unique(data[diff_dist > 2]$Cell_id)
unique(data[ratio > 2]$Cell_id)
data[, pos_dist := rucrdtw::ucrdtw_mv(interp_posBank, .SD$Mean_Grey, dtwwindow =0.9)$distance, by = Cell_id]
data[, neg_dist := rucrdtw::ucrdtw_mv(interp_negBank, .SD$Mean_Grey, dtwwindow =0.9)$distance, by = Cell_id]
data[, Responder := ifelse(pos_dist < neg_dist, TRUE,FALSE)]
data[, ratio := pos_dist/neg_dist]
data[, diff_dist := pos_dist - neg_dist]
unique(data[ratio > 2]$Cell_id)
unique(data[diff_dist > 2]$Cell_id)
data[, pos_dist := rucrdtw::ucrdtw_mv(interp_posBank, .SD$Mean_Grey, dtwwindow =0.01)$distance, by = Cell_id]
data[, neg_dist := rucrdtw::ucrdtw_mv(interp_negBank, .SD$Mean_Grey, dtwwindow =0.01)$distance, by = Cell_id]
data[, Responder := ifelse(pos_dist < neg_dist, TRUE,FALSE)]
data[, ratio := pos_dist/neg_dist]
data[, diff_dist := pos_dist - neg_dist]
unique(data[diff_dist > 2]$Cell_id)
data[, pos_dist := rucrdtw::ucrdtw_mv(interp_posBank, .SD$Mean_Grey, dtwwindow =0.1)$distance, by = Cell_id]
data[, neg_dist := rucrdtw::ucrdtw_mv(interp_negBank, .SD$Mean_Grey, dtwwindow =0.1)$distance, by = Cell_id]
data[, Responder := ifelse(pos_dist < neg_dist, TRUE,FALSE)]
data[, ratio := pos_dist/neg_dist]
data[, diff_dist := pos_dist - neg_dist]
unique(data[diff_dist > 2]$Cell_id)
unique(data[ratio > 2]$Cell_id)
unique(data[ratio > 1.5]$Cell_id)
unique(data[diff_dist > 4]$Cell_id)
unique(data[diff_dist > 3]$Cell_id)
non_responders_cells <- unique(data[diff_dist > 3]$Cell_id)
lapply(non_responders_cells, function(x)
ggplot(data[Cell_id == x])+
geom_line(aes(x = time_frame, y = Mean_Grey)))
guigui()
###### packages to use ########
library(calipR)
library(ggplot2)
library(flux)
library(rstatix)
library(calipR)
library(calipR)
guigui()
library(calipR)
library(calipR)
guigui()
guigui()
